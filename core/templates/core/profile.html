{% extends 'base.html' %}
{% load static %}

{% block head %}
    <title>Profile</title>
{% endblock %}

{% block content %}

    <div class="row">
        <div class = "col-2"></div>
        <div class="col-8">

            <br>
            <div class = "row">
                <div class="col-sm-8">
                    <h3 class="text-center text-sm-left w-100">
                        {{ profile.first_name }} {{ profile.last_name }}
                    </h3>
                </div>
                <div class="col-sm-4">
                    <p class="text-center text-sm-right w-100">
                        {{ profile.location.city }}
                    </p>
                </div>
            </div>

            <div id="carousel" class="carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                    {%  for image in profile.images.all %}
                        {% if forloop.counter0 == 0 %}
                            <li data-target="#carousel" data-slide-to="0" class="active"></li>
                        {% else %}
                            <li data-target="#carousel" data-slide-to="{{ forloop.counter0 }}"></li>
                        {% endif %}
                    {% endfor %}
                </ol>
                <div class="carousel-inner" role="listbox">
                    {% for image in profile.images.all %}
                        {% if forloop.counter0 == 0 %}
                            <div class="carousel-item active">
                                <img class="d-block img-fluid"
                                     src="{{ image.image.url }}"
                                     alt="First slide">
                            </div>
                        {% else %}
                            <div class="carousel-item ">
                                <img class="d-block img-fluid"
                                     src="{{ image.image.url }}"
                                     alt="First slide">
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
                {%  if profile.images.all|length > 1 %}
                    <a class="carousel-control-prev" href="#carousel" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carousel" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                {% endif %}
            </div>
            <div class="text-center">
                <button type = "button" class = "btn btn-outline-secondary">See All/Rate</button>
                <button type="button" class="btn btn-outline-secondary" data-toggle="modal" data-target="#photo-modal">Upload New Photo</button>

            </div>


        </div>
        <div class = "col-2"></div>
    </div>
    <br>
    <div class="row justify-content-center">

        <div class="col-sm-2">
        <h5>Possible Associates</h5>
        <div class="card border-secondary">

            <div class = "text-center">
                No associates yet...
                <br>
                <button type="submit" class="btn btn-primary">Add</button>
            </div>
            <br>
            <br>
            <br>
        </div>
        </div>

        <div class="col-sm-8">
            <h5>What people say about {{ profile.first_name }}</h5>
            <br>
            <div class="text-center star-ratings">
            {% if rating == 0 %}
                No one has rated {{ profile.first_name }} yet. Be the first?
            {% endif %}
            <form action = "#" method = "post">
                {% csrf_token %}
                {% for x in 'xxxxx' %}
                    {% if forloop.counter == rating %}
                        <input class="star-rating fas fa-star " type = "radio" name="stars" value="{{ forloop.counter }}" checked>

                    {% elif forloop.counter < rating %}
                        <input class="star-rating fas fa-star " type = "radio" name="stars" value = "{{ forloop.counter }}">
                    {% else %}
                         <input class="star-rating far fa-star " type = "radio" name="stars" value = "{{ forloop.counter }}">
                    {% endif %}
                {% endfor %}
            </form>
            </div>
            <p>
                Tags
            </p>

            <div class="card border-secondary">
                <div class="card-body">
                    <div class="text-center row">
                        <div class="col">
                            <i class="fas fa-thumbs-up"></i>
                            {% for tag in profile.pro_tags.all %}
                                <br>
                                <button type="button" class="vote-button btn btn-outline-primary m-2">{{ tag.tag.title }} ({{ tag.count }})</button>
                            {% endfor %}
                            <br>
                            <form action = "#" method="post">
                                {% csrf_token %}
                                <input id = "pro-tag-input" name="pro-tag" type="text" class="btn btn-outline-primary m-2 w-50" placeholder="(new)">
                            </form>
                        </div>
                        <div class="col">
                            <i class="fas fa-thumbs-down"></i>
                            {% for tag in profile.con_tags.all %}
                                <br>
                                <button type="button" class="vote-button btn btn-outline-primary m-2">{{ tag.tag.title }} ({{ tag.count }})</button>
                            {% endfor %}
                            <br>
                            <form action = "#" method="post">
                                {% csrf_token %}
                                <input id = "con-tag-input" name="con-tag" type="text" class="btn btn-outline-primary m-2 w-50" placeholder="(new)">
                            </form>
                        </div>
                    </div>
                    <br>
                    <div class="text-center">
                        <button  type="button" class="btn btn-dark">View All</button>
                    </div>

                </div>
            </div>
            <br>
            <br>
            <div class = "row">
                <div class = "col">
                    <p class="float-left">Comments</p>
                </div>
                <div class = "col">
                    <button id = "add-comment-button" type="button" data-toggle="collapse" data-target="#comment-box" class="btn btn-primary float-right">Add Comment</button>
                </div>
                <div class = "col">

                </div>
            </div>
            <div class = "row">
                <div class="col">
                    <div class = "collapse" id = "comment-box">
                        <form id = "leave-comment-form" action = "#" method = "post">
                            {% csrf_token %}
                            <div class = "form-group">
                                <input class = "form-control" type = "text" name = "comment-title" placeholder="Give your comment a title...">
                            </div>
                            <div class="form-group">
                                <textarea class="form-control" name="comment" id="comment-text-area" rows="6" placeholder="Now let it loose!"></textarea>
                            </div>
                            <div class = "form-group float-right">
                                <button type="submit" class="btn btn-primary">Add</button>
                            </div>
                        </form>
                    </div>
                </div>

            </div>

            {% if profile.reviews.all %}
                {% for review in profile.reviews.all|dictsortreversed:"date" %}
                    <div class="card border-secondary">
                        <div class="card-body">
                            <div class="row">
                                <div class = "col-md-8 ">
                                    <h3>{{ review.title }}</h3>
                                </div>
                                <div class = "col-md-4 text-sm-right">
                                    <small>{{ review.date|date:'m/d/Y' }}</small>
                                </div>
                            </div>
                            <div class="row">
                                <div class = "col-xs-2 text-center ">
                                    <i class="fas fa-sort-up fa-2x"></i><br>0<br><i class="fas fa-sort-down  fa-2x" ></i>


                                </div>

                                <div class = "col text-left">
                                    <p>
                                        {{ review.comment }}
                                    </p>
                                </div>


                            </div>

                        </div>
                    </div>
                    <br>
                {%  endfor %}
            {% else %}
                <div class = "text-center">
                    No comments have been left for this person yet...
                    <br>
                </div>

            {% endif %}

        </div>
        <div class = "col-sm-2">
            <div class = "card">
                <h4>History</h4>

                {% for entry in history %}
                    <div class="border border-secondary">
                     <small><strong>{{ entry.comment }}</strong></small>
                        <br>
                    <small>{{ entry.date|date:'m/d/Y f:sa' }}</small>
                    </div>

                {% endfor %}
            </div>
        </div>
    </div>


    <!-- Modal -->
    <div class="modal fade" id="photo-modal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Upload New Photo</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id = "photo-upload-form" action="#" method = "post" enctype="multipart/form-data">
                        {% csrf_token %}

                        <div class="form-group">
                            <label for="exampleInputFile">Image upload</label>
                            <input name = "image" type="file" class="form-control-file" id="input-image" >
                            <small id="fileHelp" class="form-text text-muted">Please upload a face picture for {{ profile.first_name }}.</small>
                        </div>
                    </form>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="submit" form="photo-upload-form" class="btn btn-primary">Upload</button>
                </div>
            </div>
        </div>
    </div>



{% endblock %}
{% block scripts %}
    <script type="text/javascript" src={% static 'js/profile.js' %}></script>
{% endblock %}